tag a is vec2;
tag coord ac is a;
tag coord b is a;
tag bnc is b;
tag coord c is vec2;
tag cnc is c;
tag cncnc is cnc;


void main() {
    // Test interactions between coord and non-coord things
    // Also test upcasting allowance with 'in' notation

    bnc bncvec = [0., 1.];
    
    b->ac __bac = [[1., 1.], [1., 2.]];
    ac->b __acb = [[2., -1.], [-1., 1.]];

    a s1 = bncvec in b; 
    a s2 = bncvec in ac;
    b s3 = bncvec in ac in b; // Also check that associativity works correctly

    print s1;
    print s2;
    print s3;

    cnc cncvec = [1., 2.];
    cncnc cncncvec = [.3, .6];
    c->b __cb = [[1., 2.], [-2. -1.]];

    a s4 = cncncvec in b;
    ac s5 = cncvec in ac;
    a s6 = cncvec in a; // Note that this must be through the path c->b since that's the shortest path

    print s4;
    print s5;
    print s6;

    auto __cac = __bac * __cb; // Should add c->ac to psi
    ac s7 = cncvec in ac;
    a s8 = cncvec in a; // We can only test not the type since the result is completely arbritrary (c->ac and c->b are equally long paths)

    print s7;
}